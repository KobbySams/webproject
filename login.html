<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <meta name="description" content="Login to ProAdvertise to access your account.">
    <title>Sign Up - Nalley Trends</title> <!-- Link to your main stylesheet for potential header/footer consistency -->
    <link rel="stylesheet" href="style.css"> <!-- The styles below are specific to the login form itself -->
    
    <style>
        body.login-page {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }

        .login-container {
            background-color: #fff;
            padding: 30px 40px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }

        .login-container h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 2em;
        }

        .login-container .logo-link { /* Style for the ProAdvertise link */
            text-decoration: none;
            color: #0779e4; /* Main theme color */
            font-weight: bold;
        }
        .login-container .logo-link:hover {
            text-decoration: underline;
        }


        .login-container p {
            color: #666;
            margin-bottom: 25px;
            font-size: 0.9em;
        }

        .login-form .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .login-form label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }

        .login-form input[type="email"],
        .login-form input[type="password"] {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-sizing: border-box;
            font-size: 1em;
        }

        .login-form input[type="email"]:focus,
        .login-form input[type="password"]:focus {
            outline: none;
            border-color: #0779e4;
            box-shadow: 0 0 0 2px rgba(7, 121, 228, 0.2);
        }

        .login-form .btn-login {
            background-color: #0779e4;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            width: 100%;
            transition: background-color 0.3s ease;
        }

        .login-form .btn-login:hover {
            background-color: #0056b3;
        }

        .login-links {
            margin-top: 20px;
            font-size: 0.9em;
        }

        .login-links a {
            color: #0779e4;
            text-decoration: none;
            margin: 0 10px;
        }

        .login-links a:hover {
            text-decoration: underline;
        }

        .back-to-site {
            display: block;
            margin-top: 25px;
            color: #555;
            text-decoration: none;
            font-size: 0.9em;
        }
        .back-to-site:hover {
            color: #0779e4;
            text-decoration: underline;
        }

        /* Responsive adjustments */
        @media (max-width: 480px) {
            .login-container {
                padding: 20px;
            }
            .login-container h1 {
                font-size: 1.8em;
            }
            /* Styles for phone login specific elements */
            .phone-login-form .form-group,
            .email-login-form .form-group { /* Ensure consistent form group styling */
                margin-bottom: 20px;
                text-align: left;
            }

            .phone-login-form label,
            .email-login-form label { /* Ensure consistent label styling */
                display: block;
                margin-bottom: 8px;
                font-weight: bold;
                color: #555;
            }

            .phone-login-form input[type="tel"],
            .phone-login-form input[type="text"], /* For OTP */
            .email-login-form input[type="email"],
            .email-login-form input[type="password"] { /* Ensure consistent input styling */
                width: 100%;
                padding: 12px;
                border: 1px solid #ddd;
                border-radius: 5px;
                box-sizing: border-box;
                font-size: 1em;
            }

            .phone-login-form input[type="tel"]:focus,
            .phone-login-form input[type="text"]:focus,
            .email-login-form input[type="email"]:focus,
            .email-login-form input[type="password"]:focus { /* Ensure consistent focus styling */
                outline: none;
                border-color: #0779e4;
                box-shadow: 0 0 0 2px rgba(7, 121, 228, 0.2);
            }
            
            .btn-send-otp {
                background-color: #5cb85c; /* Green, or another distinct color */
                color: white;
                padding: 10px 15px;
                border: none;
                border-radius: 5px;
                cursor: pointer;
                font-size: 1em;
                width: 100%;
                margin-bottom: 15px; /* Space before OTP field or next button */
                transition: background-color 0.3s ease;
            }
            .btn-send-otp:hover {
                background-color: #4cae4c;
            }

            .login-method-switch {
                margin-top: 15px;
                margin-bottom: 15px;
                font-size: 0.9em;
            }
            .login-method-switch a {
                color: #0779e4;
                text-decoration: none;
                cursor: pointer;
            }
            .login-method-switch a:hover {
                text-decoration: underline;
            }

            /* Initially hide the phone login form */
            .phone-login-form {
                display: none;
            }

            /* New styles for login choices */
            .login-choices-container {
                margin-bottom: 25px;
                display: flex;
                flex-direction: column;
                gap: 15px; /* Space between choice buttons */
            }
            .btn-choice {
                background-color: #f0f0f0; /* Neutral background */
                color: #333;
                padding: 12px 20px;
                border: 1px solid #ccc;
                border-radius: 5px;
                cursor: pointer;
                font-size: 1.05em; /* Slightly larger font for choices */
                font-weight: bold;
                width: 100%;
                transition: background-color 0.3s ease, border-color 0.3s ease;
                text-align: center;
            }
            .btn-choice:hover {
                background-color: #e0e0e0;
                border-color: #bbb;
            }
        }
    </style>
</head>
<body class="login-page">

    <div class="login-container">
        <h1>Login to <a href="/" class="logo-link">Nalley Trends</a></h1> <!-- Changed to root -->
        <p id="login-instruction">Please choose your login method.</p>

        <div id="loginChoices" class="login-choices-container">
            <!-- Google login button is an anchor tag for direct navigation -->
            <a href="/auth/google" class="btn-choice btn-google">Login with Google</a>
            <button id="choiceLoginPhone" class="btn-choice">Login with Phone Number</button>
            <button id="choiceLoginEmail" class="btn-choice">Login with Email</button>
        </div>

        <!-- Email Login Form -->
        <form action="/api/login" method="POST" class="login-form email-login-form" id="emailLoginForm" style="display:none;">
            <div class="form-group">
                <label for="email">Email Address</label>
                <input type="email" id="email" name="email" placeholder="you@example.com" required>
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" name="password" placeholder="Enter your password" required>
            </div>
            <button type="submit" class="btn-login">Login with Email</button>
            <div class="login-links" id="emailLoginLinks" style="display:none;"> <!-- These links are more relevant to email login -->
                <a href="#">Forgot Password?</a>
                <span>|</span>
                <a href="#">Create an Account</a>
            </div>
        </form>

        <!-- Phone Login Form (Initially Hidden) -->
        <form action="/api/phone-login" method="POST" class="login-form phone-login-form" id="phoneLoginForm" style="display:none;">
            <div class="form-group">
                <label for="phone">Phone Number</label>
                <input type="tel" id="phone" name="phone" placeholder="+1 123 456 7890" required>
            </div>
            <button type="button" class="btn-send-otp" id="sendOtpButton">Send OTP</button>
            <div class="form-group" id="otpFormGroup" style="display:none;"> <!-- Initially hide OTP group -->
                <label for="otp">OTP</label>
                <input type="text" id="otp" name="otp" placeholder="Enter 6-digit OTP" required maxlength="6">
            </div>
            <button type="submit" class="btn-login">Login with Phone</button>
        </form>
        
        <!-- Removed login-method-switch div as its functionality is replaced -->
        <!-- The Google login button is now part of loginChoices -->
        <!-- <div class="login-with-google">
            <a href="/auth/google" class="btn-google">Login with Google</a>
        </div> -->

        <a href="#" id="backToChoices" class="back-to-site" style="display:none; margin-top: 15px;">&larr; Choose another login method</a>
         <a href="/" class="back-to-site">&larr; Back to Site</a> <!-- Changed to root -->
    </div>

    <script>
        const emailLoginForm = document.getElementById('emailLoginForm');
        const phoneLoginForm = document.getElementById('phoneLoginForm');
        const loginChoicesDiv = document.getElementById('loginChoices');
        
        const choiceLoginPhoneBtn = document.getElementById('choiceLoginPhone');
        const choiceLoginEmailBtn = document.getElementById('choiceLoginEmail');
        // Google login is a direct link, no JS needed for choice itself

        const loginInstruction = document.getElementById('login-instruction');
        const emailLoginLinks = document.getElementById('emailLoginLinks'); // To hide/show forgot password etc.
        const otpInput = document.getElementById('otp');
        const otpFormGroup = document.getElementById('otpFormGroup');
        const phoneLoginButton = document.querySelector('#phoneLoginForm .btn-login');
        const backToChoicesLink = document.getElementById('backToChoices');

        function showChoices() {
            loginChoicesDiv.style.display = 'flex'; // Assuming flex for column layout
            emailLoginForm.style.display = 'none';
            phoneLoginForm.style.display = 'none';
            if(emailLoginLinks) emailLoginLinks.style.display = 'none';
            backToChoicesLink.style.display = 'none';
            loginInstruction.textContent = 'Please choose your login method.';
        }

        if (choiceLoginPhoneBtn) {
            choiceLoginPhoneBtn.addEventListener('click', function(event) {
                event.preventDefault();
                loginChoicesDiv.style.display = 'none';
                phoneLoginForm.style.display = 'block';
                emailLoginForm.style.display = 'none';
                if(emailLoginLinks) emailLoginLinks.style.display = 'none';
                backToChoicesLink.style.display = 'block';
                loginInstruction.textContent = 'Enter your phone number to receive an OTP.';
                // Initially disable OTP input and login button for phone form
                if(otpInput) otpInput.disabled = true;
                if(otpFormGroup) otpFormGroup.style.display = 'none'; // Hide OTP group initially
                if(phoneLoginButton) phoneLoginButton.disabled = true;
            });
        }

        if (choiceLoginEmailBtn) {
            choiceLoginEmailBtn.addEventListener('click', function(event) {
                event.preventDefault();
                loginChoicesDiv.style.display = 'none';
                emailLoginForm.style.display = 'block';
                phoneLoginForm.style.display = 'none';
                if(emailLoginLinks) emailLoginLinks.style.display = 'block'; // Show email specific links
                backToChoicesLink.style.display = 'block';
                loginInstruction.textContent = 'Welcome back! Please enter your email details.';
            });
        }

        if (backToChoicesLink) {
            backToChoicesLink.addEventListener('click', function(event) {
                event.preventDefault();
                showChoices();
            });
        }

        // Send OTP functionality
        const sendOtpButton = document.getElementById('sendOtpButton');
        if (sendOtpButton) {
            sendOtpButton.addEventListener('click', async function() {
            event.preventDefault();
                const phoneNumberInput = document.getElementById('phone');
                const phoneNumber = phoneNumberInput ? phoneNumberInput.value.trim() : '';

                if (phoneNumber) {
                    // In a real application, you would make an API call here
                    // to send an OTP to the phoneNumber.
                    alert('OTP request sent to ' + phoneNumber + ' (this is a demo).');
                    // This alert is now part of the try-catch block for fetch
                }

                try {
                    // Disable button to prevent multiple clicks
                    sendOtpButton.disabled = true;
                    sendOtpButton.textContent = 'Sending...';

                    const response = await fetch('/api/send-otp', { // This is the call to your server
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ phone: phoneNumber }),
                    });

                    const result = await response.json();

                    if (response.ok) {
                        alert(result.message || 'OTP sent successfully! (Check console for demo)');
                        if(otpFormGroup) otpFormGroup.style.display = 'block'; // Show OTP group
                        if(otpInput) {
                            otpInput.disabled = false; // Enable OTP input
                            otpInput.focus(); // Focus on OTP input
                        }
                        if(phoneLoginButton) phoneLoginButton.disabled = false; // Enable login button
                    } else {
                        alert(result.message || 'Failed to send OTP. Please try again.');
                    }
                } catch (error) {
                    console.error('Error sending OTP:', error);
                    alert('An error occurred while sending OTP. Please try again.');
                } finally {
                    // Re-enable button
                    sendOtpButton.disabled = false;
                    sendOtpButton.textContent = 'Send OTP';
                }
            });
        }

        // Initialize view
        showChoices(); // Show login choices by default
    </script>

</body>
<!-- Merged the second style block here -->
<style>    .login-with-google { /* This class might be reused if you have other Google buttons */
        margin-top: 20px;
    }

    .btn-google {
        display: inline-block;
        background-color: #4285F4; /* Google blue */
        color: white;
        padding: 10px 15px;
        border-radius: 5px;
        text-decoration: none;
        font-weight: bold;
        transition: background-color 0.3s ease;
    }

    .btn-google:hover { /* General Google button hover */
        background-color: #357ae8;
    }

    /* Adjustments for smaller screens */
    @media (max-width: 480px) {
        .btn-google {
            width: 100%;
        }
    }
</style>
</html>
